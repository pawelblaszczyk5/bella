{
	"annotations": {
		"list": [
			{
				"builtIn": 1,
				"datasource": { "type": "grafana", "uid": "-- Grafana --" },
				"enable": true,
				"hide": true,
				"iconColor": "rgba(0, 211, 255, 1)",
				"name": "Annotations & Alerts",
				"type": "dashboard"
			}
		]
	},
	"editable": true,
	"fiscalYearStartMonth": 0,
	"graphTooltip": 0,
	"id": 4,
	"links": [],
	"panels": [
		{
			"datasource": { "type": "prometheus", "uid": "prometheus" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": {
						"axisBorderShow": false,
						"axisCenteredZero": false,
						"axisColorMode": "text",
						"axisGridShow": true,
						"axisLabel": "",
						"axisPlacement": "auto",
						"barAlignment": 0,
						"barWidthFactor": 0.6,
						"drawStyle": "line",
						"fillOpacity": 0,
						"gradientMode": "none",
						"hideFrom": { "legend": false, "tooltip": false, "viz": false },
						"insertNulls": false,
						"lineInterpolation": "linear",
						"lineWidth": 1,
						"pointSize": 5,
						"scaleDistribution": { "type": "linear" },
						"showPoints": "auto",
						"spanNulls": 1800000,
						"stacking": { "group": "A", "mode": "none" },
						"thresholdsStyle": { "mode": "dashed" }
					},
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [
							{ "color": "green", "value": 0 },
							{ "color": "#EAB839", "value": 6 },
							{ "color": "dark-red", "value": 10 }
						]
					}
				},
				"overrides": []
			},
			"gridPos": { "h": 14, "w": 24, "x": 0, "y": 0 },
			"id": 1,
			"options": {
				"legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
				"tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
			},
			"pluginVersion": "12.1.0",
			"targets": [
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"editorMode": "code",
					"expr": "histogram_quantile(\n  0.50,\n  sum(rate(traces_spanmetrics_latency_bucket{span_name=\"Bella/Core/getResponsePlan\"}[5m])) by (le)\n)",
					"instant": false,
					"legendFormat": "P50",
					"range": true,
					"refId": "P50"
				},
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"editorMode": "code",
					"expr": "histogram_quantile(\n  0.95,\n  sum(rate(traces_spanmetrics_latency_bucket{span_name=\"Bella/Core/getResponsePlan\"}[5m])) by (le)\n)",
					"hide": false,
					"instant": false,
					"legendFormat": "P95",
					"range": true,
					"refId": "P95"
				},
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"editorMode": "code",
					"expr": "histogram_quantile(\n  0.99,\n  sum(rate(traces_spanmetrics_latency_bucket{span_name=\"Bella/Core/getResponsePlan\"}[5m])) by (le)\n)",
					"hide": false,
					"instant": false,
					"legendFormat": "P99",
					"range": true,
					"refId": "P99"
				},
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"editorMode": "code",
					"exemplar": false,
					"expr": "sum(rate(traces_spanmetrics_latency_sum{span_name=\"Bella/Core/getResponsePlan\"}[5m]))\n/\nsum(rate(traces_spanmetrics_latency_count{span_name=\"Bella/Core/getResponsePlan\"}[5m]))\n",
					"hide": false,
					"instant": false,
					"interval": "",
					"legendFormat": "Average",
					"range": true,
					"refId": "Average"
				}
			],
			"title": "Response plan generation duration",
			"type": "timeseries"
		},
		{
			"datasource": { "type": "prometheus", "uid": "prometheus" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": {
						"axisBorderShow": false,
						"axisCenteredZero": false,
						"axisColorMode": "text",
						"axisGridShow": true,
						"axisLabel": "",
						"axisPlacement": "auto",
						"barAlignment": 0,
						"barWidthFactor": 0.6,
						"drawStyle": "line",
						"fillOpacity": 0,
						"gradientMode": "none",
						"hideFrom": { "legend": false, "tooltip": false, "viz": false },
						"insertNulls": false,
						"lineInterpolation": "linear",
						"lineWidth": 1,
						"pointSize": 5,
						"scaleDistribution": { "type": "linear" },
						"showPoints": "auto",
						"spanNulls": 1800000,
						"stacking": { "group": "A", "mode": "none" },
						"thresholdsStyle": { "mode": "dashed" }
					},
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [
							{ "color": "green", "value": 0 },
							{ "color": "#EAB839", "value": 15 },
							{ "color": "dark-red", "value": 30 }
						]
					}
				},
				"overrides": []
			},
			"gridPos": { "h": 14, "w": 24, "x": 0, "y": 14 },
			"id": 4,
			"options": {
				"legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true },
				"tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
			},
			"pluginVersion": "12.1.0",
			"targets": [
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"disableTextWrap": false,
					"editorMode": "code",
					"expr": "histogram_quantile(0.5, sum by(le) (rate(traces_spanmetrics_latency_bucket{span_name=~\"Workflow/GenerateMessage\\\\([^)]+\\\\)\\\\.run\"\n}[5m])))",
					"fullMetaSearch": false,
					"includeNullMetadata": true,
					"instant": false,
					"legendFormat": "P50",
					"range": true,
					"refId": "P50",
					"useBackend": false
				},
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"editorMode": "code",
					"expr": "histogram_quantile(0.95, sum by(le) (rate(traces_spanmetrics_latency_bucket{span_name=~\"Workflow/GenerateMessage\\\\([^)]+\\\\)\\\\.run\"\n}[5m])))",
					"hide": false,
					"instant": false,
					"legendFormat": "P95",
					"range": true,
					"refId": "P95"
				},
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"editorMode": "code",
					"expr": "histogram_quantile(0.99, sum by(le) (rate(traces_spanmetrics_latency_bucket{span_name=~\"Workflow/GenerateMessage\\\\([^)]+\\\\)\\\\.run\"\n}[5m])))",
					"hide": false,
					"instant": false,
					"legendFormat": "P99",
					"range": true,
					"refId": "P99"
				}
			],
			"title": "Message generation workflow full duration",
			"type": "timeseries"
		},
		{
			"datasource": { "type": "prometheus", "uid": "prometheus" },
			"description": "Count of each model usage for fulfilled responses",
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": { "hideFrom": { "legend": false, "tooltip": false, "viz": false } },
					"decimals": 0,
					"mappings": []
				},
				"overrides": []
			},
			"gridPos": { "h": 12, "w": 12, "x": 0, "y": 28 },
			"id": 2,
			"options": {
				"displayLabels": [],
				"legend": { "displayMode": "list", "placement": "bottom", "showLegend": true },
				"pieType": "pie",
				"reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
				"tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
			},
			"pluginVersion": "12.1.0",
			"targets": [
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"disableTextWrap": false,
					"editorMode": "code",
					"exemplar": false,
					"expr": "round(\n  sum by(model) (\n    increase(model_usage_total[$__range])\n  )\n)",
					"format": "heatmap",
					"fullMetaSearch": false,
					"includeNullMetadata": true,
					"instant": false,
					"interval": "",
					"legendFormat": "__auto",
					"range": true,
					"refId": "A",
					"useBackend": false
				}
			],
			"title": "Model usage",
			"type": "piechart"
		},
		{
			"datasource": { "type": "prometheus", "uid": "prometheus" },
			"description": "Count of each response type",
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": { "hideFrom": { "legend": false, "tooltip": false, "viz": false } },
					"decimals": 0,
					"mappings": []
				},
				"overrides": [
					{
						"matcher": { "id": "byName", "options": "fulfillment" },
						"properties": [
							{ "id": "displayName", "value": "Fulfillment" },
							{ "id": "color", "value": { "fixedColor": "green", "mode": "shades" } }
						]
					},
					{
						"matcher": { "id": "byName", "options": "refusal" },
						"properties": [
							{ "id": "displayName", "value": "Refusal" },
							{ "id": "color", "value": { "fixedColor": "red", "mode": "shades" } }
						]
					}
				]
			},
			"gridPos": { "h": 12, "w": 12, "x": 12, "y": 28 },
			"id": 3,
			"options": {
				"displayLabels": [],
				"legend": { "displayMode": "list", "placement": "bottom", "showLegend": true },
				"pieType": "pie",
				"reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false },
				"tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
			},
			"pluginVersion": "12.1.0",
			"targets": [
				{
					"datasource": { "type": "prometheus", "uid": "prometheus" },
					"disableTextWrap": false,
					"editorMode": "code",
					"exemplar": false,
					"expr": "round(\n  sum by(type) (\n    increase(response_total[$__range])\n  )\n)",
					"format": "heatmap",
					"fullMetaSearch": false,
					"includeNullMetadata": true,
					"instant": false,
					"interval": "",
					"legendFormat": "__auto",
					"range": true,
					"refId": "A",
					"useBackend": false
				}
			],
			"title": "Responses",
			"type": "piechart"
		}
	],
	"preload": false,
	"schemaVersion": 41,
	"tags": [],
	"templating": { "list": [] },
	"time": { "from": "now-15m", "to": "now" },
	"timepicker": {},
	"timezone": "browser",
	"title": "Bella",
	"uid": "cd5c9e92-8be4-4bd5-bf5b-02d066a8443b",
	"version": 20
}
